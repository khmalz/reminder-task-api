 // This is your Prisma schema file,
 // learn more about it in the docs: https://pris.ly/d/prisma-schema

 generator client {
   provider = "prisma-client-js"
   output   = "../generated/prisma"
 }

 datasource db {
   provider = "sqlite"
   url      = env("DATABASE_URL")
 }

 model User {
   id         String     @id @default(cuid())
   username   String     @unique
   name       String
   password   String
   categories Category[]
   tasks      Task[]
   createdAt  DateTime   @default(now())
   updatedAt  DateTime   @updatedAt

   @@map("users")
 }

 model Task {
   id              String           @id @default(cuid())
   title           String
   isCompleted     Boolean          @default(false)
   user            User             @relation(fields: [userId], references: [id], onDelete: Cascade)
   userId          String
   categoryToTasks CategoryToTask[]
   createdAt       DateTime         @default(now())
   updatedAt       DateTime         @updatedAt

   @@index([userId])
   @@map("tasks")
 }

 model CategoryType {
   id         Int        @id @default(autoincrement())
   name       String     @unique
   categories Category[]

   @@map("category_types")
 }

 model Category {
   id              String           @id @default(cuid())
   title           String
   type            CategoryType     @relation(fields: [typeId], references: [id], onDelete: Cascade)
   typeId          Int
   categoryToTasks CategoryToTask[]
   user            User             @relation(fields: [userId], references: [id], onDelete: Cascade)
   userId          String
   createdAt       DateTime         @default(now())
   updatedAt       DateTime         @updatedAt

   @@index([typeId])
   @@map("categories")
 }

 model CategoryToTask {
   category   Category @relation(fields: [categoryId], references: [id], onDelete: Cascade)
   categoryId String

   task   Task   @relation(fields: [taskId], references: [id], onDelete: Cascade)
   taskId String

   @@id([categoryId, taskId])
   @@index([taskId])
   @@map("category_to_tasks")
 }
