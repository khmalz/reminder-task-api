#!/bin/sh

echo "Running pre-commit hook: Auto-fixing and linting affected projects..."

# Jalankan eslint --fix untuk auto-fix di semua project yang terdampak
pnpm --filter "...[main]" run lint --fix

# Setelah auto-fix, jalankan linting untuk memastikan tidak ada error tersisa
pnpm --filter "...[main]" run lint --quiet --max-warnings=0

if [ $? -ne 0 ]; then
  echo "Lint found errors after auto-fix. Commit aborted."
  exit 1
fi

echo "Lint passed (after auto-fix if needed). Proceeding with commit..."
echo
exit 0
